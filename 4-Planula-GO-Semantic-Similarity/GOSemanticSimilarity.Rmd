---
title: "GO Semantic Similarity"
author: "Erin Chille"
date: "Last updated 2021/02/16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Prepare workspace
```{r, message=FALSE, warning=FALSE}
rm(list=ls()) # removes all prior objects
library(tidyverse)
library(org.Hs.eg.db)
library(simplifyEnrichment)
library(magick)
```

#Cluster 1 (downregulated in low, upregulated in ambient, middle in low)

Load GO data and select only the GO_IDs associated with BP and MF terms
```{r, message=FALSE, warning=FALSE}
clust1.GO <- read_csv("3-Planula-GO-Enrichment-Analysis/Output/GO.05.C1.csv", col_names = TRUE)
nrow(clust1.GO) # total #enriched terms
nrow(filter(clust1.GO, ontology=="BP")) #BP terms
nrow(filter(clust1.GO, ontology=="CC")) #CC terms
nrow(filter(clust1.GO, ontology=="MF")) #MF terms
clust1.GO.BP <- clust1.GO %>% filter(ontology == "BP")
clust1.BP <- clust1.GO.BP$category
clust1.GO.MF <- clust1.GO %>% filter(ontology == "MF")
clust1.MF <- clust1.GO.MF$category
```

Calculate a similarity clust1 matrix and save the output.
```{r}
#BP View
clust1 = GO_similarity(clust1.BP, ont = "BP", db = "org.Hs.eg.db")
simplifyGO(clust1, word_cloud_grob_param = list(max_width = 50), max_words=20)

#BP Save
pdf(file = "4-Planula-GO-Semantic-Similarity/Output/clust1.BP_GOSEM.pdf", width = 7, height = 5)
simplifyGO(clust1, word_cloud_grob_param = list(max_width = 50), max_words=20)
dev.off()

#MF View
clust1 = GO_similarity(clust1.MF, ont = "MF", db = "org.Hs.eg.db")
simplifyGO(clust1, word_cloud_grob_param = list(max_width = 50), max_words=20)

#MF Save
pdf(file = "4-Planula-GO-Semantic-Similarity/Output/clust1.MF_GOSEM.pdf", width = 7, height = 5)
simplifyGO(clust1, word_cloud_grob_param = list(max_width = 50), max_words=20)
dev.off()
```

#Cluster 2 (downregulated in ambient, upregulated in low, middle in low)
Load GO data and select only the GO_IDs associated with BP and MF terms
```{r, message=FALSE, warning=FALSE}
clust2.GO <- read_csv("3-Planula-GO-Enrichment-Analysis/Output/GO.05.C2.csv", col_names = TRUE)
nrow(clust2.GO) # total #enriched terms
nrow(filter(clust2.GO, ontology=="BP")) #BP terms
nrow(filter(clust2.GO, ontology=="CC")) #CC terms
nrow(filter(clust2.GO, ontology=="MF")) #MF terms
clust2.GO.BP <- clust2.GO %>% filter(ontology == "BP")
clust2.BP <- clust2.GO.BP$category
clust2.GO.MF <- clust2.GO %>% filter(ontology == "MF")
clust2.MF <- clust2.GO.MF$category
```

Calculate a similarity clust2 matrix and save the output.
```{r}
#BP View
clust2 = GO_similarity(clust2.BP, ont = "BP", db = "org.Hs.eg.db")
simplifyGO(clust2, word_cloud_grob_param = list(max_width = 50), max_words=20)

#BP Save
pdf(file = "4-Planula-GO-Semantic-Similarity/Output/clust2.BP_GOSEM.pdf", width = 7, height = 5)
simplifyGO(clust2, word_cloud_grob_param = list(max_width = 50), max_words=20)
dev.off()

#MF View
clust2 = GO_similarity(clust2.MF, ont = "MF", db = "org.Hs.eg.db")
simplifyGO(clust2, word_cloud_grob_param = list(max_width = 50), max_words=20)

#MF Save
pdf(file = "4-Planula-GO-Semantic-Similarity/Output/clust2.MF_GOSEM.pdf", width = 7, height = 5)
simplifyGO(clust2, word_cloud_grob_param = list(max_width = 50), max_words=20)
dev.off()
```